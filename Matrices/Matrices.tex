




R Workshop

Matrices

Creating a matrix

Accessing Rows and Columns

Addition and subtractions

Diagonals and the Identity Matrix

Linear Algebra Functions

Eigenvalues and Eigenvectors

More on Matrices

Using rbind() and cbind()

Solving a System of Linear Equations

 

Creating a matrix


Matrices can be created using the matrix() command. 


The arguments to be supplied are 


    1) vector of values to be entered

    2) dimensions of the matrix, specifying either the numbers of rows or columns.


Additionally you can specify if the values are to be allocated by row or column. 

By default they are allocated by column.









Vec1 = c(1,4,5,6,4,5,5,7,9)             # 9 elements


A = matrix(Vec1,nrow=3)                 #3 by 3 matrix. Values assigned by column.


A


C= matrix(  c(1,6,7,0.6,0.5,0.3,1,2,1), ncol=3 , byrow =TRUE)


C                                               #3 by 3 matrix. Values assigned by row.

 


Accessing Rows and Columns


Particular rows and columns can be accessed by specifying the row number or column number, leaving the other value blank.









A[1,]   # access first row of A


C[,2]   # access second column of C
 





Addition and subtractions


For matrices, addition and subtraction works on an element- wise basis. 

The first elements of the respective matrices are added, and so on.










A+C                                             


A–C
 





Matrix Multiplication


To multiply matrices, we require a special operator for matrices; “%*%”. 


If we just used the normal multiplication, we would get an element-wise multiplication.


Basic Matrix Calculations


1) Inverting a matrix 


To invert a matrix we use the command solve() with no additional argument.


We can use this same command to solve a system of linear equations Ax=b

We would specify the vector b as the additional argument.



2) Computing the determinant


To compute the determinant, the command is simply det()



3) Compute the transpose 


To compute the transpose of matrix A, we use the command t().



4) Determining the dimensions 


To find the dimensions of matrix A, we use the dim() command


5) Cross Products


We can compute cross products using the crossprod () command. 









solve(A)                            # Inverse of Matrix A    


t(A)                                  # tranpose of A


det(A)                               # determinant of A  


det(t(A))                           # determinant of the transpose of A


A %*% C                           # Matrix Multiplication


C * A                                #Casewise Multiplication
 



Diagonals and the Identity Matrix


The diag() command is a very versatile function for using matrices.


It can be used to create a diagonal matrix with elements of a vector in the principal diagonal. 

For an existing matrix, it can be used to return a vector containing the elements of the principal diagonal. 


Most importantly, if k is a scalar, diag() will create a k x k identity matrix.










Vec2=c(1,2,3)


diag(Vec2)     #       Constructs a diagonal matrix based on values of Vec2


diag(A)          #        Returns diagonal elements of A as a vector


diag(3)          #       creates a 3 x 3 identity matrix


diag(diag(A)) #        Creates the diagonal matrix D of matrix A ( Jacobi Method)
 




Linear Algebra Functions


R supports many import linear algebra functions such as cholesky decomposition, trace, rank, eigenvalues etc.


The required results may be determinable from the output of a command that pertains to an overall approach.









eigen(A)       #eigenvalues and eigenvectors       

                                                                      

qr(A)            #returns Rank of a matrix


svd(A)
 



Eigenvalues and Eigenvectors


The eigenvalues and eigenvectors can be computed using the eigen() function.  A data object is created.


This is a very important type of matrix analysis, and many will encounter it again in future modules.










Y = eigen(A)


names(Y)


#   y$val are the eigenvalues of A

#   y$vec are the eigenvectors of A 

 




More on Matrices

 

Note that the following commands are useful for Experimental Design.

 

rowMeans(A)                                         Returns vector of row means.

rowSums(A)                                             Returns vector of row sums. 

colMeans(A)                                             Returns vector of column means. 

colSums(A)                                               Returns vector of coumn means. 

 







--------------------------------------------------------------------------------



Using rbind() and cbind()

Another methods of creating a matrix is to “bind” a number of vectors together, either by row or by column. 

The commands are rbind() and cbind() respectively.








> x1 =c(1,2) ; x2 = c(3,8)                                                


> D= rbind(x1,x2)


> E = cbind(x1,x2)


> det(D)


[1] 2


> det(E)


[1] 2

 


Solving a System of Linear Equations


To solve a system of linear equations in the form Ax=b , where A is a square matrix, and b is a column vector of known values, we use the solve() command to determine the values of the unknown vector x.










b=vec2  # from before


solve(A, b) 
 



\section{Matrices}

%\end{document}
\section{Matrices}
\subsection{Creating a matrix}
Matrices can be created using the \texttt{matrix()} command. The arguments to be supplied are 1) vector of values to be entered
2) Dimensions of the matrix, specifying either the numbers of rows or columns.

Additionally you can specify if the values are to be allocated by row or column. By default they are allocated by column.
\begin{verbatim}
Vec1=c(1,4,5,6,4,5,5,7,9)		# 9 elements
A=matrix(Vec,nrow=3)		#3 by 3 matrix. Values assigned by column.
A
B= matrix(c(1,6,7,0.6,0.5,0.3,1,2,1),ncol=3,byrow =TRUE)
B				          #3 by 3 matrix. Values assigned by row.
\end{verbatim}	
If you have assigned values by column, but require that they are assigned by row, you can use the transpose function
\begin{verbatim}
t().
t(A)				# Transpose
A=t(A)	
\end{verbatim}

Another methods of creating a matrix is to "bind" a number of vectors together, either by row or by column. The commands are rbind() and cbind() respectively.
\begin{verbatim}
x1 =c(1,2) ; x2 = c(3,6)
rbind(x1,x2)
cbind(x1,x2)
\end{verbatim}




Particular rows and columns can be accessed by specifying the row number or column number, leaving the other value blank.
\begin{verbatim}
A[1,]	  # access first row of A
B[,2]   # access first column of B
\end{verbatim}
Addition and subtractions
For matrices, addition and subtraction works on an element- wise basis. The first elements of the respective matrices are added, and so on.
A+B
A-B

Matrix Multiplication
To multiply matrices, we require a special operator for matrices; "%*%".
If we just used the normal multiplication, we would get an element-wise multiplication.
A * B  		#Element-wise multiplication
A %*% B  	#Matrix multiplication
We can compute crossproducts using the crossprod () command. If only one matrix is used it
\begin{framed}
\begin{verbatim}
crossprod(A,B) 		# A'B
crossprod(A) 			# A'A
\end{verbatim}
\end{framed}
Diagonals
The diag() command is a very versatile function for using matrices.
It can be used to create a diagonal matrix with elements of a vector in the principal diagonal. For an existing matrix, it can be used to return a vector containing the elements of the principal diagonal.


Most importantly, if k is a scalar, diag() will create a k x k identity matrix.

\begin{framed}
\begin{verbatim}
Vec2=c(1,2,3)
diag(Vec2)	#	Constructs a diagonal matrix based on values of Vec2
diag(A)	#        Returns diagonal elements of A as a vector
diag(3)	#	creates a 3 x 3 identity matrix
diag(diag(A)) #  	Diagonal matrix D of matrix A ( Jacobi Method)
\end{verbatim}
\end{framed}
Determinants, Inverse Matrices and solving Linear systems
To compute the determinant of a square matrix, we simply use the det() command
det(A)
det(B)
To find the inverse of a square matrix, we use the solve() command, specifying only the matrix in question
solve(A)

To solve a system of linear equations in the form Ax=b , where A is a square matrix, and b is a column vector of known values, we use the solve() command to determine the values of the unknown vector x.
b=vec2  # from before
solve(A, b)
Row and Column Statistics.
Statistic on the rows and columns can easily be computed if required.
%rowMeans(A)  # Returns vector of row means.
%rowSums(A)  # Returns vector of row sums.
%colMeans(A)  # Returns vector of column means.
%colSums(A)  # Returns vector of coumn means.
\subsection{Eigenvalues and Eigenvectors}
The eigenvalues and eigenvectors can be computed using the eigen() function.  A data object is created.
This is a very important type of matrix analysis, and many will encounter it again in future modules.

Y = eigen(A)
names(Y)
"	y$val are the eigenvalues of A
"	y$vec are the eigenvectors of A

?
Part 2 Revision on Earlier Material
"	Accessing a column of a data frame
"	Accessing a row of a data frame

A particular row can be accessed by specifying the row index , while leaving the column index empty

Info [4,]			# Fourth row of "Info" is called

A sequence of rows can be accessed by specifying a sequence of rows as follows.

Info [10:15,]		# tenth row to fifteenth row of "Info" is called


\subsection{Subsetting datasets by rows}

Suppose we wish to divide a data frame into two different section. The simplest approach we can take is to create two new data sets, each assigned data from the relevant rows of the original data set.

Suppose our dataset ``Info" has the dimensions of 200 rows and 4 columns. We wish to separate "Info" into two subsets , with the first and second 100 rows respectively. ( We call these new subsets "Info.1" and "Info.2".)
\begin{verbatim}
Info.1 = Info[1:100,]		#assigning "info" rows 1 to 100
Info.2 = Info[101:200,]		#assigning "info" rows 101 to 200
\end{verbatim}

More useful commands such as rbind() and cbind()  can be used to manipulate vectors.

