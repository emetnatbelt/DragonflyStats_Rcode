\chapter { R Graphics}
\section Enhancing your scatter plots
\subsection{Adding lines}
Previously we have used scatter plots to plot bivariate data. They were constructed using the plot() command.
Recall that we can use the arguments \texttt{xlim} and \texttt{ylim} to control the vertical and horizontal range of the plots, by specifying a two element vector (min and max) for each.

Using the \texttt{abline()} command, we can add lines to our scatter plots. We specify the argument according to the type of line required. A demonstration of three types of line is provided below.
Additionally we change the colour of the added lines, by specifying a colour in the \texttt{col} argument. We can also change the line type to one of four possible types, using the \texttt{lty} argument.

The line types are follows
\begin{itemize}
	\item	\texttt{lty =1}   Normal full line (default)
	\item	\texttt{lty =2}   Dashed line
	\item	\texttt{lty =3}   Dotted line
	\item	\texttt{lty =4}   Dash-dot line
\end{itemize}
\footnotesize \begin{verbatim}
x=rnorm(10)
y=rnorm(10)
plot(x,y)
plot(x,y,xlim=c(-4,4),ylim=c(-4,4))
abline(v =0 , lty =2 )    # add a vertical dotted line (here the y-axis) to the plot
abline(h=0  ,lty =3)    # add a horizontal dotted line (here the x-axis) to the plot
abline(a=0,b=1,col="green") # add a line to your plot with intercept "a" and slope "b"
\end{verbatim}\normalsize

\subsection{Changing your plot character}

To change the plot character (the symbol for each covariate, we supply an additional argument to the plot() function.  This argument is formulated as pch=n where n is some number.
Additionally we change the colour of the characters, by specifying a colour in the col argument.
\footnotesize \begin{verbatim}
plot(x,y,pch=15,col="red")		#Square plot symbols
plot(x,y,pch=16,col="green")		#Orb plot symbols
plot(x,y,pch=17,col="mauve")		#Triangular plot symbols
plot(x,y,pch=36	,col="amber")		#Dollar sign plot symbols
\end{verbatim}\normalsize
Recall that we can add new variates to an existing scatterplot using the points() function. Remember to set the vertical and horizontal limits accordingly.
\footnotesize \begin{verbatim}
y1 = rnorm(10); y2 = rnorm(10)
plot(x,y1, pch=8,col="purple" ,xlim=c(-5,5),ylim=c(-5,5))
points(x,y2,pch=12,col="green")
\end{verbatim}\normalsize
\subsection{Adding the regression model line}

The \texttt{abline()} function can be used to add a regression model line  by supplying as an argument the \texttt{coef()} values for intercept and slope estimates .These estimates can be inputted directly by using both functions in conjunction.

\footnotesize \begin{verbatim}
Fit1 =lm(y1~x);  coef(Fit1)
abline(coef(Fit1))	
\end{verbatim}\normalsize

\subsection{Adding a title }

It is good practice to label your scatterplots properly. You can specify the following argument
\begin{itemize}
	\item	main="Scatterplot Example", 	This provides the plot with a title
	\item	sub="Subtitle",                 This adds a subtitle
	\item	xlab="X variable ",				This command labels the x axis 
	\item   ylab="y variable ",				This command labels the y-axis
\end{itemize}
We can also add text to each margin, using the \texttt{mtext()} command.  
We simply require the number of the side. (1 = bottom, 2=left,3=top,4=right). 
We can change the colour using the col argument.
\footnotesize \begin{verbatim}
plot(x,y,main="Scatterplot Example",   sub="subtitle",    xlab="X variable ", ylab="y variable ")	
mtext("Enhanced Scatterplot", side=4,col="red ")
\end{verbatim}\normalsize
Alternatively , we can also use the command title() to add a title to an existing scatterplot.
\footnotesize \begin{verbatim}
title(main="Scatterplot Example)	
\end{verbatim}\normalsize


\section{Combining plots}
It is possible to combine two plots. We used the graphical parameters command \texttt{par()} to create an array. 
Often we just require two plots side by side or above and below. We simply specify the numbers of rows and columns of this array using the \texttt{mfrow} argument, passed as a vector.

\begin{verbatim}
par(mfrow=c(1,2))
plot(x,y1)			# draw first plot
plot(x,y2)			# draw second plot
par(mfrow=c(1,1))		# reset to default setting.
\end{verbatim}

\section{Plot of single vectors}
If only one vector is specified i.e. \texttt{plot(x)},  the plot created will simply be a scatter-plot of the values of x against their indices.

$plot(x)$
Suppose we wish to examine a trend that these points represent. We can connect each covariate using a line.

$plot(x, type = "l")$
If we wish to have both lines and points, we would input the following code. This is quite useful if we wish to see how a trend develops over time.
$plot(x, type = "b")$











\section{Histograms}
Histograms can be created using the \texttt{hist()} command.
To create a histogram of the car weights from the Cars93 data set
\footnotesize
\begin{myindentpar}{1cm}
	\begin{verbatim}
	hist(mtcars$mpg, main="Histogram of MPG (Data: MTCARS) ")
	\end{verbatim}
\end{myindentpar}\normalsize
\texttt{R} automatically chooses the number and width of the bars. We can
change this by specifying the location of the break points.
\footnotesize
\begin{myindentpar}{1cm}
	\begin{verbatim}hist(Cars93$Weight, breaks=c(1500, 2050, 2300, 2350, 2400,
	2500, 3000, 3500, 3570, 4000, 4500), xlab="Weight",
	main="Histogram of Weight")
	\end{verbatim}
\end{myindentpar}\normalsize



\section{Boxplot}
Boxplots can be used to identify outliers.

By default, the \texttt{boxplot()} command sets the orientation as vertical. By adding the argument \texttt{horizontal=TRUE}, the orientation can be changed to horizontal.
\footnotesize
\begin{framed}
	\begin{verbatim}
	boxplot(mtcars$mpg, horizontal=TRUE, xlab="Miles Per Gallon",
	main="Boxplot of MPG")
	\end{verbatim}
\end{framed}

%\begin{figure}
%  Requires \usepackage{graphicx}
%  \includegraphics[scale=0.4]{MTCARSboxplot.png}\\
%  \caption{Boxplot}\label{boxplot}
%\end{figure}



\newpage


\chapter{Data Visualization}
\section{Plots}
This section is an introduction for producing simple graphs with
the R Programming Language.
\begin{itemize}
	\item Line Charts  \item Bar Charts \item Histograms \item Pie
	Charts \item Dotcharts
\end{itemize}



\section{Plots}
This section is an introduction for producing simple graphs with
the R Programming Language.
\begin{itemize}
\item Line Charts  \item Bar Charts \item Histograms \item Pie
Charts \item Dotcharts
\end{itemize}


\begin{itemize}
\item
\item
\end{itemize}
\footnotesize \begin{verbatim}
> code here
 \end{verbatim}\normalsize


\subsection{ Charts}

\begin{myindentpar}{1cm}
\begin{verbatim}
# Define 2 vectors cars <- c(1, 3, 6, 4, 9) trucks <- c(2, 5, 4,
5, 12)

# Calculate range from 0 to max value of cars and trucks g_range
<- range(0, cars, trucks)

# Graph autos using y axis that ranges from 0 to max # value in
cars or trucks vector.  Turn off axes and # annotations (axis
labels) so we can specify them ourself plot(cars, type="o",
col="blue", ylim=g_range,
   axes=FALSE, ann=FALSE)

# Make x axis using Mon-Fri labels axis(1, at=1:5,
lab=c("Mon","Tue","Wed","Thu","Fri"))

# Make y axis with horizontal labels that display ticks at # every
4 marks. 4*0:g_range[2] is equivalent to c(0,4,8,12). axis(2,
las=1, at=4*0:g_range[2])

# Create box around plot box()

# Graph trucks with red dashed line and square points
lines(trucks, type="o", pch=22, lty=2, col="red")

# Create a title with a red, bold/italic font title(main="Autos",
col.main="red", font.main=4)

# Label the x and y axes with dark green text title(xlab="Days",
col.lab=rgb(0,0.5,0)) title(ylab="Total", col.lab=rgb(0,0.5,0))

# Create a legend at (1, g_range[2]) that is slightly smaller #
(cex) and uses the same line colors and points used by # the
actual plots legend(1, g_range[2], c("cars","trucks"), cex=0.8,
   col=c("blue","red"), pch=21:22, lty=1:2);

\end{verbatim}
\end{myindentpar}
\subsection{Bar charts}
\begin{myindentpar}{1cm}
\begin{verbatim}
# Define the cars vector with 7 values
cars <- c(1, 3, 6, 4, 9, 5, 7)
# Graph cars
barplot(cars)
\end{verbatim}
\end{myindentpar}
\subsection{Boxplots}
\subsection{Setting graphical parameters}
\subsection{Miscellaneous}
The following code can be used to make variations of the plots.

\begin{myindentpar}{1cm}
\footnotesize \begin{verbatim}
# Make an empty chart
plot(1, 1, xlim=c(1,5.5), ylim=c(0,7), type="n", ann=FALSE)

# Plot digits 0-4 with increasing size and color
text(1:5, rep(6,5), labels=c(0:4), cex=1:5, col=1:5)

# Plot symbols 0-4 with increasing size and color
points(1:5, rep(5,5), cex=1:5, col=1:5, pch=0:4)
text((1:5)+0.4, rep(5,5), cex=0.6, (0:4))

# Plot symbols 5-9 with labels
points(1:5, rep(4,5), cex=2, pch=(5:9))
text((1:5)+0.4, rep(4,5), cex=0.6, (5:9))

# Plot symbols 10-14 with labels
points(1:5, rep(3,5), cex=2, pch=(10:14))
text((1:5)+0.4, rep(3,5), cex=0.6, (10:14))

# Plot symbols 15-19 with labels
points(1:5, rep(2,5), cex=2, pch=(15:19))
text((1:5)+0.4, rep(2,5), cex=0.6, (15:19))

# Plot symbols 20-25 with labels
points((1:6)*0.8+0.2, rep(1,6), cex=2, pch=(20:25))
text((1:6)*0.8+0.5, rep(1,6), cex=0.6, (20:25))
\end{verbatim}\normalsize
\end{myindentpar}




\subsection{Lattice Graphs}
\subsection{setting up}
Execute the following command:
\begin{myindentpar}{1cm}
\begin{verbatim}
library(lattice)
\end{verbatim}
\end{myindentpar}
For information on lattice, type:
\begin{myindentpar}{1cm}
\begin{verbatim}
help(package = lattice)
\end{verbatim}
\end{myindentpar}
The examples in this section are generally drawn from the R documentation and Murrell (2006).

Murrell gives three reasons for using Lattice Graphics:

They usually look better.
They can be extended in powerful ways.
The resulting output can be annotated, edited, and saved

\subsection{3 Dimensional Graphs}
How to do a 3-d graph

\newpage
